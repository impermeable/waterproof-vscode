name: Test installation script

on: [workflow_dispatch]

concurrency:
  group: ${{ github.ref }}
  cancel-in-progress: true

jobs:

  build:
    name: build
    runs-on: ubuntu-latest

    steps:
      - name: Set up git repository
        uses: actions/checkout@v3

      - name: Show directory
        run: ls

      - name: Add a user
        run: sudo useradd waterproof -m
    
      - name: Check whether home directory is created
        run: ls /home/

    #   - name: Show directory
    #     run: ls

      - name: Install opam
        run: sudo bash ./setup-opam.sh
    
      - name: Make opam switch and install coq-lsp and waterproof
        run: bash ./install.sh